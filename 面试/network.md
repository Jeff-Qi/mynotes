# TCP
## osi,tcp/ip，五层协议体系结构各层协议
1.  osi七层模型：应用层、表示层、会话层、传输层、网络层、数据链路层、物理层
2.  tcp/ip：网络接口层，网际层、传输层、应用层
3.  五层：物理层、数据链路层、网络层、传输层、应用层
4.  协议
    1.  物理层：rj45，IEEE802.4
    2.  数据链路层：ppp、vlan、mac
    3.  网络层：ip、icmp、arp、rarp、ospf
    4.  传输层：tcp、udp、rip
    5.  会话层：sql
    6.  表示层：
    7.  应用层：http、ftp、ssh、telnet、smtp
5.  作用
    - 物理层:通过媒介传输比特，确定机械及电规范(此特Bit)
    - 数据链路层:将比特组装成帧和点到点的传递(帧Frame)
    - 网络层:负责数据包从源到宿的传递和网际互连(包PackeT)
    - 传输层:提供端到端的可靠报文传递和错误恢复(段Segment)
    - 会话层:建立、管理和终止会话(会话协议数据单元SPDU)
    - 表示层:对数据进行翻译、加密和压缩(表示协议数据单元PPDU)
    - 应用层:允许访问OSI环境的手段(应用协议数据单元APDU)

##  TCP/UDP区别
1.  tcp面向连接的可靠传输协议，有状态可控；udp是无连接的不可靠传输协议，无状态不可控。
2.  tcp注重安全可靠；udp注重传输速度。
3.  tcp协议：smtp邮件传输协议、telnet远程登录、http从web端获取数据；udp协议：tftp：简单的文件传输协议

## tcp三次握手四次挥手
1.  三次握手：客户端发送syn数据包，请求连接，进入发送等待；服务端收到syn，回复ack+syn数据包，确认准备连接，进入接收等待；客户端收到syn+ack数据包后，回复ack数据包，完成后两端进入完成状态，开始传送数据。
2.  四次挥手：客户端主动发送fin包断开链接，进入客户端收到后发送ack；服务端发送fin包主动请求断开链接，客户端收到后回复ack；服务端收到ack后关闭链接，客户端等待两个报文最大生存时间后关闭连接。

### 等待两个两个最大报文生存时间
1.  1 个 MSL 确保四次挥手中主动关闭方最后的 ACK 报文最终能达到对端
2.  1 个 MSL 确保对端没有收到 ACK 重传的 FIN 报文可以到达

### 为什么是三次握手不是两次
- 防止实效的数据包传送到服务端产生错误
- a发送一个连接后，超时在发送了一个；第二个包到达后，开始链接传输，完成后断开；此时第一个数据包网络问题好了以后到达b，a如果不确认b就会一直等待a发送数据，造成资源浪费。

## 介绍一下tcp报文
1.  源端口、目的端口、seq number、ack number、lsn初始序列号、标记为、窗口大小、校验和、可选项

## TCP报文中时间戳的作用
1.  计算报文的往返时间RTT
2.  防止序列号回绕：seq 范围0~2^32-1,最大值后置0；可以使用时间戳来区别因置零产生的相同序列号的数据包

## TCP 的流量控制
- 对于发送端和接收端而言，TCP 需要把发送的数据放到发送缓存区, 将接收的数据放到接收缓存区。
- 而流量控制索要做的事情，就是在通过接收缓存区的大小，控制发送端的发送。如果对方的接收缓存区满了，就不能再继续发送了。

### 滑窗机制
- 分为发送窗口和接收窗口
- 初始窗口200，a发送100，b接收100，处理50，窗口向右移动50，并缩小为150；

## tcp拥塞控制
- 当前网络特别差，特别容易丢包，那么发送端就应该注意调整发送速度
    1.  核心：拥塞窗口和慢启动阈值
    2.  算法：慢启动、拥塞避免、快速重传和快速恢复

### 拥塞窗口
- 目前自己还能传输的数据量大小
- 接收窗口：接收端；拥塞窗口：发送端===>发送窗口大小 = min(拥塞窗口，接收窗口)

### 慢启动
1.  连接成功后，双方宣告接收窗口大小；
2.  初始化拥塞窗口；
3.  每次接收到一个ACK确认时，拥塞窗口翻一倍，达到慢启动阈值后减缓增加

### 拥塞避免
1.  当拥塞窗口到达阈值后，每次收到ACK确认报文，增加一个拥塞窗口

### 快速重传（是否需要重传）
- 当数据包丢失时，发送端需要重新发送；当接收端接收到的数据包不是按序到达的，则要求发送端重新发送；
    - 比如第 5 个包丢了，即使第 6、7 个包到达的接收端，接收端立刻返回第 4 个包的 ACK。当发送端收到 3 个重复 ACK 时，意识到丢包了，于是马上进行重传，不用等到一个 RTO 的时间到了才重传。

### 选择性重传
- 在收到发送端的报文后，接收端回复一个 ACK 报文，在这个报文首部的可选项中，就添加上SACK这个属性，通过left edge和right edge告知发送端已经收到了哪些区间的数据报。

### 快速恢复
- 发送端收到三次重复 ACK 之后，发现丢包，觉得现在的网络已经有些拥塞了，自己会进入快速恢复阶段
- 改变策略：
    1.  拥塞阈值降低为 cwnd 的一半
    2.  cwnd 的大小变为拥塞阈值
    3.  cwnd 线性增加

# HTTP
## http与https

### http、https
- http：超文本传输协议，负责客户端与服务端之间的传输html等内容的协议，基于tcp协议
- https：https为加密的http等同于http+ssl/tls

### 区别
1.  https加密，传输更安全
2.  http默认80端口，https443
3.  https传输层完成加密

### https工作原理
1.  服务端发送公钥证书给客户端
2.  客户端验证证书有效性，生成回话私钥，通过公钥加密发送给服务端
3.  服务端私钥解密会话，获得客户端的私钥
4.  利用会话私钥进行通信

### 常用的http方法
- get：从服务器获取资源
- post：传输实体主体，发送给服务端信息
- head：获取报文头部，不返回主体信息，确认URL有效性
- put：传输文件
- option：获取服务器支持的方法

### 常见状态码
- 200：成功
- 301：永久从定向删除源地址，保留定向地址
- 302：暂时从定向
- 304：访问本地缓存资源
- 400：语法错误
- 403：服务器拒绝访问
- 404：资源不存在
- 500：服务器错误

### 简述报文格式

###  http1.0、http1.1、http2.0
- HTTP1.0：每个请求发起一个tcp链接，频繁创建和取消赵成资源浪费
- HTTP1.1：长连接，keep-alive字段；支持断点续传；增加管道
- HTTP2.0：多路复用，建立在一个tcp连接之上；头部压缩

### 输入一个url之后都经历了什么
1.  将url转化为ip地址；查询浏览器DNS缓存，本地DNS缓存，DNS服务器
2.  建立tcp连接，向服务器发送请求
3.  协商加密，加密完成
4.  客户端发送get/post请求数据，发送请求头；服务器返回响应，返回响应头，发送数据，浏览器渲染
5.  关闭链接

### Post 和 Get 的区别
1.  get可以请求缓存，而post不行
2.  post通过传送报文主体可以比get发送更多的信息
3.  get一般用来请求某个数据，而post则是发送相关的信息
4.  post相较于get方法更安全一些，get会直接将信息放在url头部中。post存在报文主体中
5.  post一般用于有副作用的不等幂的操作

### cookie与session
1.  **cookie**
    1.  因为http是无状态的协议所以，在页面跳转后，服务器就不认识你了，就需要重新登录；所有使用cookie进程一个状态的管理
2.  特点：
    1.  明文
    2.  容易被攻击和篡改
    3.  大小受限
3.  **session**
    1.  比coolie更加安全，session依赖cookie，就是利用cookie，实现的“会话”
    2.  session会下发一个秘钥（cookie）（乱码），客户端每次访问都携带这个秘钥，那么服务器如果发现这个秘钥吻合，就能够显示这个用户曾经保存的信息。
4.  区别
    1.  cookie数据存放在客户的浏览器上；session数据放在服务器缓存中。
    2.  cookie是明文，不安全，别人利用cookie可以被篡改和攻击；而session存放服务器缓存中并且加密的，其他用户看不到。
    3.  session会在一定时间内保存在服务器上。当用户访问增多，会比较占用你服务器内存，考虑到减轻服务器性能方面，使用cookie。
    4.  单个cookie保存的数据不能超过4K,如果cookie的内容超过4K的话，那么调用的时候就会返回一个空的字符串；session的密钥（cookie),可以对应无限大的数据
