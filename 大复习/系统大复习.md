## Day 1

### 进程/线程/协程是什么
1.  进程：程序在自身的虚拟地址空间中的一次执行活动；在内存中形成一个自己的内存体，有自己的地址空间和栈；是计算机分配资源的最小单位；
2.  线程：线程是资源利用的最小单位；
3.  协程：协程是一种用户态的线程；有程序来决定；运行于一个线程中，没有协程切换的开销；在子程序运行的过程中可以中断去做其他的子程序；

### 进程和程序之前的关系
1.  程序与进程：程序是静态的指令+数据的集合；进程是一个动态的执行果过程，具有生命周期；
2.  进程能够申请、调度和独立运行；程序不能调用资源，也不能被系统调用；
3.  程序与进程无一一对应关系；程序能够被多个进程公用，一个进程也能顺序运行多个程序；

### 进程和线程通信机制
1.  进程间通信：
    1.  管道：半双工通信，管道通信允许具有亲缘关系的进程之间进行通信
    2.  命名管道：允许没有亲缘关系的进程间通信
    3.  信号：一种复杂的通信方式，通过通知接收进程某事件已经完成；
    4.  信号量：实质上是一种计数器，通过计数来标记资源是否可使用，来控制进程间对于资源的访问，作为一种锁机制，确保进程在使用时不会被其他进程影响；是进程间或同一进程下的不同线程之间的同步的一种手段
    5.  共享内存：一个进程创建的一块共享内存，可以被其他的一些进程所访问，实现进程间通信；通常和其他的通信方式配合使用比如信号量；是最快的IPC通信方式
    6.  消息队列：
    7.  套接字：可是在不同的主机上的进程之间的通信
2.  线程之间的通信：
    1.  互斥锁：通过对资源加上互斥锁来防止对过线程对同一资源的访问；
    2.  共享锁：对资源加上共享锁后，进程对于该资源的读操作不收影响，但是会排斥写操作；
    3.  信号量：有名信号量和无名信号量；实质是一个计数器，通过计数来标识该资源是否可被使用，如果为0则资源当前不可用；
    4.  条件变量 + 互斥锁来控制资源的访问；以原子的方式阻塞线程，知道条件为真为止

### 进程类型

### 进程调度

### Linux网络IO模型

### select/poll/epoll

### COW技术
- 写时复制
- fork 父进程会复制一份完整的父进程的数据来创建一个新的子进程，但是这种做法可能造成系统的资源浪费；父子进程的数据不能共享；而且，如果子进程马上做出了改动，则刚刚的复制就失去了作用；COW 技术是为了推迟甚至免除复制数据；当 fork 父进程进程时，不会产生复制一份数据来创建子进程，而是通过让父子进程以只读的形式来共享一份数据拷贝，只有在父子进程进行exec操作的时候才会进程一次完整的数据拷贝，是父子进程独立；这样就能减少资源的浪费

## Day 2

### 文件操作
1.  目录和文件权限
    - 权限：r（4）、w（2）、x（1）
        - 目录的 x 权限是可以进入这个目录；文件的 x 权限是让文件可执行让文件可以被运行
        - 目录的 w 权限是可以在其下删除创建文件或目录；文件的 w 权限是让文件内容可以修改
        - 目录的 r 权限是可以列出其下的所有文件或目录；文件的 r 权限是让文件可读
    - 所属：所属用户、所有组
        - 用户对于文件或目录的操作，由这个文件或目录的权限的权限来决定用户放问文件或目录需要其所属用户是自己，或者是所属组成员；或者第三方访问权限开放
        - 优先级：UID > GID > OTHER
    - 文件查看 ls：文件类型、链接数、文件权限、属主、属组、文件大小、文件最近修改时间、文件名
2.  软硬链接
  - 硬链接：创建一个硬链接时，只在文件目录的 block 中记录链接的档名，直接指向源文件的 inode；通过原文件的 inode 的链接计数来确定文件的可用性，删除时硬链接更安全，当 inode 的连接数为 0 时删除这个文件；不会占用新的 inode 和 block；但是不能跨文件系统或者对目录创建硬链接
  - 软连接：创建一个软连接时，需要占用创建一个新的 inode 和 block，block中记录的是源文件的档名，指向该档名的所在的 inode；符号链接更加灵活，能够链接目录和跨文件创建；删除软连接不会影响源文件；源文件删除或文件的位置发生改动，软连接记录的位置不变导致链接失效

### 权限管理
1.  文件修改：
    1.  chmod
    2.  chown
    3.  chgrp
2.  unmask
    - 默认权限掩码；告诉系统生成文件时不应该给那些权限  
3.  特殊权限：SUID、SGID、STID
    1.  SUID（需要有 x 权限，变为 s）
        - 文件：使用所属用户的权限来运行
        - 目录：其下所有新建的文件、目录都是目录所属主的归属
    2.  SGID（需要有 x 权限，变为 s）
        - 文件：使用所属组的权限来运行
        - 目录：创建的所有文件或目录都是所属组的归属
    3.  STID（需要有 x 权限，变为 t）
        - 目录下的所有文件或者目录只能所属用户和 root 来删除
4.  文件 ACL 访问控制
    - 给予用户更灵活的访问控制列表来对任何用户的权限给予
        1.  可以针对任意指定用户和组设置 rwx 权限
        2.  避免用户对文件使用 777 权限带来的风险
    - getfacl、setfacl

### 文件系统
1.  存储设备上的组织文件的方法；在告知系统分区所在的起始与结束柱面后，需要将分区格式化为操作系统能够识别的文件系统，之后操作系统才能使用这个文件系统；Linux 文件系统通常将文件的权限和属性放置到 inode 节点中，将实际的数据放置到 block；inode 和 block 块都有自己的编号
2.  超级块：
    - 记录整个文件系统的整体信息包括 inode 与 block 的总量、使用数量和余量等
3.  inode：
    - 记录文件的权限和属性等信息；同时记录这个文件数据的 block 块的编号
4.  block：
    - 记录文件的真实数据，如果一个文件较大会使用多个 block 来存储
5.  目录树：
    - 每一个目录都占用一个 inode，目录名（档名）存储在 block 中；当我们访问一个文件的时候都是首先通过 / 目录的 inode 找到根目录的 block 找到记录有下一级记录的 inode，这样一层一层的查找下去直到找到对应的文件
6.  新建文件
    1.  判断对当前所在目录是否有 w x 权限，如果有就继续
    2.  从 inode 位图找出空闲的 inode，将属性和权限等信息写入
    3.  从 black 位图找出空闲的 block，将数据写入
    4.  同步 inode bitmap 和 block bitmap；更新 superblock
    5.  **创建文件的两大先决条件：1. 还有剩余的磁盘空间 2. 还有剩余的 inode 节点**
7.  挂载点
    - 挂载点是进入文件系统的入口
    - 一定是一个目录
8.  查看文件系统
    ```shell
    ls -l /lib/modules/$(uname -r)/fs

    ls /proc/filesystems
    ```
9.  常见的文件系统
    1.  xfs
    2.  ext2/3/4
10. linux分区
    - 3 + 1：三个主分区 + 一个扩展分区（可有多个逻辑分区）

### 计划任务
1.  at：一次性计划任务，在指定时间完成一次操作
2.  crontab：周期性计划任务，周期性执行
    - 格式：分 + 时 + 日 + 月 + 星期 + 命令

### 文本三剑客 grep、sed、awk

#### grep
1.  文本过滤工具，打印匹配的行；可使用正则表达式
1.  参数：
    ```
    -i：忽略大小写
    -o：只显示匹配的行
    -w：匹配整个单词
    -v：反选
    -n：显示行号
    -c：统计匹配到的行数
    -e：多个条件的或关系
    -q：安静模式，不显示匹配的行
    -A：前#行
    -B：后#行
    -C：前后#行
    -E：使用扩展正则表达式
    ```
1.  字符匹配

匹配符 | 作用
---|---
. | 匹配任意字符
.* | 任意字符任意次
[  ] | 匹配指定范围内的字符
[^] | 匹配指定范围外的字符
[[:digit:]] | 数字
[[:lower:]] | 小写字母
[[:upper:]] | 大写字母
[[:alpha:]] | 字符
[[:alnum:]] | 字符和数字
[[:space:]] | 水平和垂直的空白字符
[[:blank:]] | 水平空白字符
[[:punct:]] | 标点符号

1.  匹配次数

匹配符 | 匹配次数
---|---
\* | 匹配其前面字符任意次，包括0次；贪婪模式：尽可能长的匹配
\+ | 匹配其前面字符至少1次
\? | 匹配其前面字符0或1次
\{m,n\} | 匹配其前面字符至少m次至多n次
\{n\} | 匹配其前面字符n次
\{n,\} | 匹配其前面字符至少n次
\{,n\} | 匹配其前面字符至多n次

1.  位置锚定

锚定符 | 作用
---|---
^ | 锚定行首
$ | 锚定行位
\< | 锚定词首
\> | 锚定词尾

#### sed
1.  行编辑器，sed是一种流编辑器
2.  参数

参数 | 作用
---|---
-n | 不输出模式空间内容到屏幕
-e | 多点编辑
-f /path/to/script_file | 从指定文件中读取编辑脚本
-r | 支持使用扩展正则表达式
-i | 原处编辑

3.  动作
    ```
    a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)
    i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)
    c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！
    d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；
    p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行～
    s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！
    ```
3.  锚定符

位置 | 解释
---|---
默认 | 全文
\# | 第#行
$ | 最后一行
\#,# | 第#行到第 # 行
\#,+# | 第#行到第 # + # 行
~ | 步进 1~2 奇数行；2~2 偶数行

#### awk
1.  分析工具
2.  

### 其他

####  启动流程
1.  加电 BIOS 自检
2.  选择启动设备，加载 MBR 加载 bootloader
    1.  stage 1：加载 MBR 的前 446 bytes，用于加载 stage 1.5
    2.  stage 1.5：加载 MBR 之后的扇区，加载的 stage 2 所在分区的文件系统驱动，让 stage 1 中的 bootloader 能够识别 stage 2 所在分区的文件系统
    3.  stage 2：主要加载内核和 ramdisk 这个临时根文件系统，具体的文件夹是 /boot/grub
3.  内核初始化
    1.  先检查所有的硬件设备
    2.  加载硬件驱动
    3.  以只读方式加载根目录
    4.  运行用户空间的第一个程序 /sbin/init
4.  init 程序启动用户空间的进程
    1.  根据 init 的配置文件设置运行级别
        - centos6 init 程序是 upstart 配置文件在 /etc/inittab 和 /etc/init/\*.conf
        - centos6 init 程序是 systemd 配置文件在 /usr/lib/system/systemd/* 和 /etc/systemd/system/*
    2.  运行系统初始化脚本完成系统初始化
    3.  启动开机自启动程序
5.  初始化终端，等待用户操作


- 接电 BIOS 自检---加载MBR---加载 /boot---加载内核并初始化---设置运行等级---系统初始化---初始化终端---等待用户操作

## Day 3

### selinux
1.  selinux作为内核型的加强性防火墙，提高对系统的安全保护，通过selinux对系统中的文件和资源添加标签，从而提高安全性；
2.  运行级别：enforcing(强制不可以访问)、permissive(警告但可以访问)、disabled( 不警告不拒绝)
3.  安全上下文
    1.  安全上下文我自己把它分为「进程安全上下文」和「文件安全上下文」。一个「进程安全上下文」一般对应多个「文件安全上下文」只有两者的安全上下文对应上了，进程才能访问文件
4.  命令
    1.  更改文件或目录上下文 chcon、restorecon
    2.  布尔型规则 getsebool、setsebool
    3.  添加目录的默认安全上下文：semanage fcontext -a -t；添加端口 semanage port -a -t

### iptables
1.  Netfilter是一种内核中用于扩展各种网络功能的结构化底层构架，由内核提供，无需守护进程
1.  专表专用
    1.  filter：专门用于过滤数据
    1.  nat：用于地址转换（只匹配初始连接数据，随后使用连接跟踪）
    1.  mangle：用于修改数据包头的内容
    1.  raw：用于在连接追踪前预处理数据
2.  专链专用
    1.  PREROUTING：用于匹配最先接触到的数据(raw,mangle,nat)
    1.  INPUT：用于匹配到达本机的数据(mangle,filter)
    1.  FORWARD：用于匹配穿越本机的数据(mangle,filter)
    1.  OUTPUT：用于匹配从本机发出的数据(raw,mangle,nat,filter)
    1.  POSTROUTING：用于匹配最后离开的数据(mangle,nat)
3.  iptables 命令
    1.  iptables -t -AIDRLFZNXP -psd(sport)(dport)io -j
4.  netfiles 对于流量的处理规则：
    1.  检查点表查询顺序：
        - raw、mangle、nat、filter
    2.  链匹配规则
        1.  入站流量：prerouting、input
        2.  出站流量：output、postrouting
        3.  转发流量：prerouting、forward、postrouting

### ﬁrewalld
1.  centos 和 rhel提供了一个firewalld的动态管理的防火墙；firewalld将所有网络流量分为多个区域进行管理
2.  将流量根据数据包的源IP地址或传入网络接口等条件，流量将转入相应区域的防火墙规则，对于流入系统的每个数据包，将首先检查其源地址；特定区域、指定网络接口的区域、默认区域

### SSL/TLS
1.  SSL 安全套接字
    1.  位于可靠的面向连接的网络层协议和应用层协议之间的一种协议层。SSL通过互相认证、使用数字签名确保完整性、使用加密确保私密性，以实现客户端和服务器之间的安全通讯
2.  TLS 传输层安全协议
    1.  用于在两个通信应用程序之间提供保密性和数据完整性是 SSL 的升级版
3.  SSL/TLS 的握手过程

### 对称和非对称加密
1.  对称加密：通信的双方采用同样的秘钥进行加密解密
    1.  优点：秘钥较短，方便简单，加密速度快
    2.  缺点：秘钥的传输不安全，可能存在秘钥泄露
    3.  常见 DES,IDEA,AES 加密算法
2.  非对称加密：采用公钥加密，私钥解密的办法来通信
    1.  优点：可以更好的保证秘钥的安全性
    2.  缺点：加密更加消耗资源
    3.  常见 RSA

## Day 3

### 内存
1.  free：显示系统内存的使用
2.  vmstat：报告虚拟内存的统计信息

### CPU
1.  uptime：显示系统平均负
2.  top：动态显示系统进程任务
3.  mpstat：输出CPU的各种统计信息

### 进程
1.  进程的管理和查看
    1.  ps、top、pstree
    2.  kill、killall、pkill
        1.  kill 常见信号量
            1.  （1）sighup 读取配置重启
            2.  （2）sigint = ctrl + C 中断服务
            3.  （9）sigkill 立即杀死进程及其子进程
            4.  （15）sigterm 杀死进程，等待程序正常退出
            5.  （18）sigcont 继续运行
            6.  （19）sigstop 暂停运行

### 网络
1.  临时性网络配置，直接通过修改当前内核参数；永久修改，需要修改配置文件，然后重启网络接口
2.  管理以太网接口
    1.  ifconfig：ifup、ifdown
    2.  ifconfig <网络接口> <IP地址> [Mask <子网掩码>] [Broadcast <广播地址>]
    3.  route add|del [-net|-host] <target [netmask Netmask]> [gw Gateway] [[dev] Interface]
3.  设置主机名和包转发
    1.  echo "1" > /proc/sys/net/ipv4/ip_forward
    2.  hostname <主机名>
4.  永久配置网络（更改配置文件）
    1.  /etc/sysconfig/network
    2.  /etc/sysconfig/network-script/
    3.  /etc/hosts（域名解析文件）
    4.  /etc/resolv.conf（域名解析服务器）
5.  域名解析网络检车
    1.  netstat
    2.  ping、traceroute
    3.  dig、nslookup
6.  wget -hbqOaortc --user --passoword

### 磁盘
1.  fdisk：磁盘分区工具；parted：动态交互分区
2.  lvm：逻辑盘卷管理（Logical Volume Manager）的简称，它是Linux 环境下对卷进行方便操作的抽象层
    1.  是磁盘和分区上的一层逻辑结构，对文件系统屏蔽了下层磁盘的分区布局；可以组织不同磁盘的分区来组装成一个新的逻辑上的分区，这样就可以在逻辑上将多个磁盘合并成一个块更大的磁盘
    2.  创建物理卷（PV 中有 PE 概念；这个是 lvm 的最小寻址单位）、创建卷组（VG：简历在物理卷之上）、创建逻辑卷（LV：从卷组中划出一块区域创建）
    3.  使用：
        1.  pvcreate <磁盘或分区设备名>
        2.  vgcreate <卷组名> <物理卷设备名> [...]
        3.  lvcreate <-L 逻辑卷大小> <-n 逻辑卷名> <卷组名>
        4.  lvcreate <-l PE值> <-n 逻辑卷名> <卷组名>
        5.  掌握扩容与缩容的步骤
3.  文件系统挂载
    1.  mount、unmout、fuser
    2.  /etc/fstab 各个参数的含义
